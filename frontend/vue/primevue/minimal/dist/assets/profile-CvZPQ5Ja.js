import{e as m,c as p,o as w,a as o,f as s,n as C,P as i,t as f,d as F,a9 as B,l as S,aV as x,Z as I,j as h,ap as $,g as _,aU as N}from"./index-D462s2qb.js";import{s as U}from"./index-CDpYWBTz.js";import{a as E}from"./index-ggVQrxbj.js";import{s as b}from"./index-Capuxi7Q.js";import{s as y}from"./index-EN2eqwjt.js";import{s as z}from"./index-DA-YKbrC.js";import{s as D}from"./index-Cq1e0zRu.js";import{_ as M}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DKTsTgk9.js";const O={class:"password-strength"},Z={class:"flex justify-content-between mt-1"},G={class:"text-sm text-500"},L={__name:"PasswordStrength",props:{password:{type:String,default:""}},setup(k){const g=k,d=m(()=>{const a=g.password||"";return{length:a.length>=8,uppercase:/[A-Z]/.test(a),lowercase:/[a-z]/.test(a),number:/[0-9]/.test(a),special:/[!@#$%^&*(),.?":{}|<>]/.test(a)}}),r=m(()=>Object.values(d.value).filter(Boolean).length),v=m(()=>r.value/5*100),P=m(()=>r.value<=2?"strength-weak":r.value<=3?"strength-fair":r.value<=4?"strength-good":"strength-strong"),n=m(()=>r.value<=2?"text-red-500":r.value<=3?"text-orange-500":r.value<=4?"text-blue-500":"text-green-500"),c=m(()=>r.value<=2?"Weak":r.value<=3?"Fair":r.value<=4?"Good":"Strong"),l=m(()=>{const a=[];return d.value.length||a.push("8+ chars"),d.value.uppercase||a.push("uppercase"),d.value.lowercase||a.push("lowercase"),d.value.number||a.push("number"),d.value.special||a.push("special char"),a.length===0?"All requirements met":`Missing: ${a.join(", ")}`});return(a,V)=>(w(),p("div",O,[o(i(D),{value:v.value,showValue:!1,style:{height:"8px"},class:C(P.value)},null,8,["value","class"]),s("div",Z,[s("span",{class:C(["text-sm",n.value])},f(c.value),3),s("span",G,f(l.value),1)])]))}},R=M(L,[["__scopeId","data-v-c1fef22c"]]),W={class:"flex flex-column gap-4 p-3"},H={class:"grid"},J={class:"col-12 md:col-6"},K={class:"flex flex-column gap-2"},Q={class:"flex flex-column gap-2"},T={key:0,class:"text-red-500"},X={class:"flex flex-column gap-2"},Y={class:"flex flex-column gap-2"},ss={class:"flex"},es={class:"flex flex-column gap-2"},as={class:"mt-2"},ls={class:"col-12 md:col-6"},rs={class:"flex flex-column gap-2"},ts={key:0,class:"text-red-500"},os={class:"flex flex-column gap-2"},ns={key:0,class:"text-red-500"},is={class:"flex flex-column gap-2"},ds={key:0,class:"text-red-500"},us={class:"mt-2"},cs={__name:"profile",setup(k){const g=F(),d=B(),r=m(()=>g.user),v=S(!1),P=S(!1),n=x({email:"",name:""}),c=x({email:""}),l=x({currentPassword:"",newPassword:"",confirmPassword:""}),a=x({currentPassword:"",newPassword:"",confirmPassword:""});I(()=>{r.value&&(n.email=r.value.email||"",n.name=r.value.name||"")});const V=()=>{let t=!0;return c.email="",n.email.trim()?/\S+@\S+\.\S+/.test(n.email)||(c.email="Invalid email format",t=!1):(c.email="Email is required",t=!1),t},j=()=>{let t=!0;return Object.keys(a).forEach(e=>a[e]=""),l.currentPassword||(a.currentPassword="Current password is required",t=!1),l.newPassword?l.newPassword.length<6&&(a.newPassword="Password must be at least 6 characters",t=!1):(a.newPassword="New password is required",t=!1),l.confirmPassword?l.newPassword!==l.confirmPassword&&(a.confirmPassword="Passwords do not match",t=!1):(a.confirmPassword="Please confirm your new password",t=!1),t},q=async()=>{if(V()){v.value=!0;try{await N.updateProfile({email:n.email,name:n.name}),await g.fetchProfile(),d.success("Profile updated successfully")}catch(t){d.error(t.response?.data?.message||"Failed to update profile")}finally{v.value=!1}}},A=async()=>{if(j()){P.value=!0;try{await N.changePassword({currentPassword:l.currentPassword,newPassword:l.newPassword}),d.success("Password changed successfully"),l.currentPassword="",l.newPassword="",l.confirmPassword=""}catch(t){d.error(t.response?.data?.message||"Failed to change password")}finally{P.value=!1}}};return(t,e)=>(w(),p("div",W,[s("div",H,[s("div",J,[o(i(U),{class:"h-full"},{title:h(()=>[...e[5]||(e[5]=[s("div",{class:"flex align-items-center gap-2"},[s("i",{class:"pi pi-user text-primary"}),s("span",null,"Profile Information")],-1)])]),content:h(()=>[s("form",{onSubmit:$(q,["prevent"]),class:"flex flex-column gap-3"},[s("div",K,[e[6]||(e[6]=s("label",{for:"username",class:"font-medium"},"Username",-1)),o(i(b),{id:"username",value:r.value?.username,disabled:"",class:"w-full"},null,8,["value"]),e[7]||(e[7]=s("small",{class:"text-color-secondary"},"Username cannot be changed",-1))]),s("div",Q,[e[8]||(e[8]=s("label",{for:"email",class:"font-medium"},"Email *",-1)),o(i(b),{id:"email",modelValue:n.email,"onUpdate:modelValue":e[0]||(e[0]=u=>n.email=u),type:"email",invalid:!!c.email,class:"w-full"},null,8,["modelValue","invalid"]),c.email?(w(),p("small",T,f(c.email),1)):_("",!0)]),s("div",X,[e[9]||(e[9]=s("label",{for:"name",class:"font-medium"},"Name",-1)),o(i(b),{id:"name",modelValue:n.name,"onUpdate:modelValue":e[1]||(e[1]=u=>n.name=u),class:"w-full"},null,8,["modelValue"])]),s("div",Y,[e[10]||(e[10]=s("label",{class:"font-medium"},"Role",-1)),s("div",ss,[o(i(z),{value:r.value?.role,severity:r.value?.role==="Admin"?"danger":"info"},null,8,["value","severity"])])]),s("div",es,[e[11]||(e[11]=s("label",{class:"font-medium"},"Department",-1)),s("span",null,f(r.value?.departmentName||"Not assigned"),1)]),s("div",as,[o(i(E),{type:"submit",label:"Update Profile",loading:v.value,icon:"pi pi-check"},null,8,["loading"])])],32)]),_:1})]),s("div",ls,[o(i(U),{class:"h-full"},{title:h(()=>[...e[12]||(e[12]=[s("div",{class:"flex align-items-center gap-2"},[s("i",{class:"pi pi-lock text-primary"}),s("span",null,"Change Password")],-1)])]),content:h(()=>[s("form",{onSubmit:$(A,["prevent"]),class:"flex flex-column gap-3"},[s("div",rs,[e[13]||(e[13]=s("label",{for:"currentPassword",class:"font-medium"},"Current Password *",-1)),o(i(y),{id:"currentPassword",modelValue:l.currentPassword,"onUpdate:modelValue":e[2]||(e[2]=u=>l.currentPassword=u),feedback:!1,toggleMask:"",invalid:!!a.currentPassword,inputClass:"w-full",class:"w-full"},null,8,["modelValue","invalid"]),a.currentPassword?(w(),p("small",ts,f(a.currentPassword),1)):_("",!0)]),s("div",os,[e[14]||(e[14]=s("label",{for:"newPassword",class:"font-medium"},"New Password *",-1)),o(i(y),{id:"newPassword",modelValue:l.newPassword,"onUpdate:modelValue":e[3]||(e[3]=u=>l.newPassword=u),toggleMask:"",feedback:!1,invalid:!!a.newPassword,inputClass:"w-full",class:"w-full"},null,8,["modelValue","invalid"]),o(R,{password:l.newPassword},null,8,["password"]),a.newPassword?(w(),p("small",ns,f(a.newPassword),1)):_("",!0)]),s("div",is,[e[15]||(e[15]=s("label",{for:"confirmPassword",class:"font-medium"},"Confirm New Password *",-1)),o(i(y),{id:"confirmPassword",modelValue:l.confirmPassword,"onUpdate:modelValue":e[4]||(e[4]=u=>l.confirmPassword=u),feedback:!1,toggleMask:"",invalid:!!a.confirmPassword,inputClass:"w-full",class:"w-full"},null,8,["modelValue","invalid"]),a.confirmPassword?(w(),p("small",ds,f(a.confirmPassword),1)):_("",!0)]),s("div",us,[o(i(E),{type:"submit",label:"Change Password",loading:P.value,icon:"pi pi-lock",severity:"warning"},null,8,["loading"])])],32)]),_:1})])])]))}},_s=M(cs,[["__scopeId","data-v-213f7bf2"]]);export{_s as default};
